* USB概念及基础 
** 杂项 
- usb设备未配置之臆，最多从vbus上获取100ma. 配置之后，最多可以到500ma.
- 位填充6个一样的反转一次。0翻转，1-不反转

** 数据传输 
*** 枚举过程
- 控制传输   setup data status
  - 复位 地址为0   SE0  10ms
  - 获取地址0端点0的设备描述符  18bytes
     setup阶段 data 只获取8字节，第八字节处是端点0容量
  - 再次复位
  - 设置地址 地址0端点0 包含新地址  
       - 获取状态请求  设备状态  主机ack 新地址启用
  - 获取设备描述符  18 如果设备端点0小于18字节，会有多个请求数据输入（即IN令牌)
  - 获取配置描述符  9
  - 获取配置描述符集合  配置 接口 类 端点 
  - 字符串描述符  报告描述符

*** 包结构
  - 同步域
    - 低/全  00000001  pid0 pid1
    - 高速   31 0 1
  - 包标识符PID
    - pid1-0  01 令牌
                  pid3-0  0001 out  host输出数据
                          1001 in
                          0101 sof 帧起始  没有数据传输
                          1101 setup 将要开始控制传输

              11 data
                  pid3-0  0011 data0
                          1011  data1
                          0111 data2
                          1111 mdata
              10 握手
                  pid3-0  0010  ACK
                          1010  NAK
                          1110  STALL
                          0110  NYET 未准备好

              00  特殊
                  pid3-0  1100  前导 打开低速
                          1100  错误
                          1000  split
                          0100  ping


  - EOP
    - 低/全 2bits 单端0(SE0) 是指d+ d- 都为低
    - 高速  

*** 帧结构
  - 令牌
    - sof  
       同步 pid 11位帧号 5位crc eop
    - out in setup
       同步  pid 7位地址 4号端点号 5位crc eop
  - 数据包
       同步 pid byte0 1 2 ..  16位crc eop
  - 握手包
       同步 pid eop
  - 特殊包
       pre  同步 pid eop   低速开启

*** usb事务
  - 批量传输、等时传输、中断传输 都是一个事务，控制传输：建立过程，状态过程各一个事务，数据过程多个事务
  - 令牌阶段 数据阶段  握手阶段
  - 控制传输  建立事务   数据事务 data1  状态事务  data1






